services:
  zipkin:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/zipkin:latest 
    container_name: zipkin
    ports:
      - 9411:9411
    restart: always
  
  redis:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/redis:6.0.10
    container_name: redis
    ports:
      - 6379:6379
    restart: always
    volumes:
      - /data/redis/redis.conf:/etc/redis.conf
      - /data/redis/data:/data
    command: redis-server /etc/redis.conf

  
  rabbitmq:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/rabbitmq:rabbitmq-delayed-3.8.9 
    container_name: rabbitmq
    ports:
      - 5672:5672
      - 15672:15672
    restart: always
    environment:
      - "RABBITMQ_DEFAULT_USER=lingxi"
      - "RABBITMQ_DEFAULT_PASS=lingxi"
    volumes:
      - /data/rabbitmq/data:/var/lib/rabbitmq
      - /data/rabbitmq/logs:/var/log/rabbitmq/log
  
  nacos:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/nacos:v2.1.0
    container_name: nacos
    ports:
      - 8848:8848
      - 9848:9848
    environment:
      - "MODE=standalone"
    volumes:
      - /data/nacos/data:/home/nacos/data
      - /data/nacos/logs:/home/nacos/logs
    restart: always 
    
  elasticsearch:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/elasticsearch:8.3.11
    container_name: es
    ports:
      - 9200:9200
      - 9300:9300
    environment:
      - "discovery.type=single-node"
      - "ES_JAVA_OPTS=-Xms512m -Xmx1024m"
      - "ELASTIC_PASSWORD=lingxi"
      - "TAKE_FILE_OWNERSHIP=true"
    volumes:
      - /data/es/data:/usr/share/elasticsearch/data:rw
      - /data/es/logs:/usr/share/elasticsearch/logs:rw
      - /data/es/conf/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml
    restart: always

  
  kibana:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/kibana:7.10.1
    container_name: kibana
    ports:
      - 5601:5601
    links:
      - "elasticsearch:elasticsearch"
    environment:
      - "ELASTICSEARCH_HOSTS=http://elasticsearch:9200"
      - "ELASTICSEARCH_USERNAME=elastic"
      - "ELASTICSEARCH_PASSWORD=lingxi"
    restart: always

  arthas: 
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/arthas:v1
    container_name: arthas
    ports:
      - 8080:8080
      - 7777:7777
    restart: always
  
  seata-server:
    image: registry.cn-guangzhou.aliyuncs.com/jdkj/seate-server:1.6.0
    ports:
      - "7091:7091"
      - "8091:8091"
    environment:
      - STORE_MODE=db
      - SEATA_IP=seata_ip  #修改成对应ip
      - SEATA_PORT=8091
    volumes:
      - "/usr/share/zoneinfo/Asia/Shanghai:/etc/localtime"   
      - "/usr/share/zoneinfo/Asia/Shanghai:/etc/timezone"  
      - "/data/seata/application.yml:/seata-server/resources/application.yml"
    restart: always 

